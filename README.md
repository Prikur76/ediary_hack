# Хакинг электронного дневника школы

Этот скрипт предназначен для корректировки оценок, удаления замечаний и создания похвалы 
от преподавателей в отношении выбранного ученика.

## Описание работы скрипта
Скрипт, в зависимости от задачи (корректировки негативных оценок, удаления замечаний и создания похвалы) сначала 
проверяет наличие ученика, и если по заданным параметрам таких несколько - сообщит об ошибке, если такой отсутствует - 
также вернет ошибку.

В случае успеха - в консоль поступит сообщение об отсутствии негативных оценок, замечаний или наличия похвалы по 
выбранному предмету за последний доступный урок. Текст похвалы выбирается в случайном порядке. 

## Запуск
Предполагается, что у вас установлен **`python3`** и вы умеете пользоваться консолью и запускать через неё команды. 

#### Вариант 1. Если есть доступ к серверу 'Электронного дневника'. 

* Скачайте файл [scripts.py](scripts.py) и разместите в директории проекта 'Электронного дневника' рядом с файлом **`manage.py`**.
* Откройте shell командой **`python manage.py shell`**.
* В открывшемся окне введите команду импорта: 
```
from scripts import fix_marks, remove_chastisements, create_commendations
```
* В зависимости от задачи используйте следующие команды:

а). Исправить негативныне оценки ученика (введите фамилию и имя, можно строчными буквами):
```bash
fix_marks('голубев феофан')
```
б). Удалить замечания преподавателей (введите фамилию и имя, можно строчными буквами):
```bash
remove_chastisements('голубев феофан')
```
в). Создать похвалу преподавателя (первым аргументом введите фамилию и имя, можно строчными буквами, 
вторым аргументом укажите предмет, значение по умолчанию - 'физкультура'):
```bash
create_commendations('голубев феофан', 'музыка')
```
Пример:
```
(venv) C:\Users\User\DEVMAN\DJANGO_ORM\03_Lesson\e-diary>python manage.py shell
Python 3.10.8 (tags/v3.10.8:aaaf517, Oct 11 2022, 16:50:30) [MSC v.1933 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>>
>>> from scripts import fix_marks, remove_chastisements, create_commendations
>>>
>>> fix_marks('голубев феофан')
Оценки изменены
>>>
>>> remove_chastisements('голубев феофан')
Замечания удалены
>>>
>>> create_commendations('голубев феофан', 'музыка')
Похвала создана
```
* Затем откройте [сайт электронного дневника](http://127.0.0.1:8000/6/%D0%90), проверьте результат.

Лайфхак: в shell можно быстро вернуться к уже выполненной команде, нажав кнопку “вверх”, затем отредактировать её и запустить повторно.

#### Вариант 2. Если доступ к серверу 'Электронного дневника' отсутствует.
- Настройка сайта локально:
  * Для начала скачайте [репозиторий с дневником](https://github.com/devmanorg/e-diary/tree/master).
  * Установите зависимости командой  **`pip install -r requirements.txt`**.
  * Настройте переменные окружения (см. ниже). 
  * По ссылке скачайте [архив с файлом базы данных](https://dvmn.org/filer/canonical/1562234129/166/) внутри, или используйте свой. 
  * Чтобы подключить файл базы данных, разместите его в корневом каталоге проекта.
  * Создайте БД командой **`python3 manage.py migrate`**
  * Запустите сервер командой **`python3 manage.py runserver`**.
  * По ссылке [http://127.0.0.1:8000](http://127.0.0.1:8000) вы увидите сайт как на скриншоте:
  
![image](https://dvmn.org/media/1_CekU9U9.png).

- Использование подготовленных скриптов:
  * Скачайте файл [scripts.py](scripts.py) и разместите в директории проекта 'Электронного дневника' рядом 
  с файлом **`manage.py`**.
  * В отдельном окне откройте shell командой **`python manage.py shell`**.
  * В открывшемся окне введите команду импорта: 
    ```
    from scripts import fix_marks, remove_chastisements, create_commendations
    ```
Далее, использование - как показано в примерах выше.

## Переменные окружения
Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл **`.env`** рядом с **`manage.py`**
и запишите туда данные в таком формате: ПЕРЕМЕННАЯ=значение.

Доступны 3 переменные:

**`DEBUG`** — дебаг-режим. Поставьте True, чтобы увидеть отладочную информацию в случае ошибки.\
**`SECRET_KEY`** — секретный ключ проекта\
**`ALLOWED_HOSTS`** — см [документацию Django](https://docs.djangoproject.com/en/3.1/ref/settings/#allowed-hosts).\
**`DATABASE_NAME`** — путь до базы данных, например: `schoolbase.sqlite3`.

## Полезные материалы:

* [Документация к сайту](https://github.com/devmanorg/e-diary/tree/master#%D0%BF%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F)
* [Как запустить Django shell](https://www.csestack.org/open-python-shell-django/)
* [Статья. Как достать данные из БД](https://devman.org/encyclopedia/django_orm/getting-data/)
* [Видео как пользоваться shell](https://www.youtube.com/watch?v=Zh7DuWHTpFQ)
* [Описание на Django Girls, как работать с фильтрами](https://tutorial.djangogirls.org/ru/django_orm/#%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D0%BE%D0%B2)
* [Статья про CRUD с сайта metanit](https://metanit.com/python/django/5.3.php)
* [Фильтрация по связанным объектам](https://docs.djangoproject.com/en/4.0/topics/db/queries/#lookups-that-span-relationships)
* [Пример фильтрации на SO](https://stackoverflow.com/questions/11508744/django-models-filter-by-foreignkey)
* [Примеры текстов похвалы](https://pedsovet.org/beta/article/30-sposobov-pohvalit-ucenika)

## Цели проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org).
